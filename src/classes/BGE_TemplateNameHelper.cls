public with sharing class BGE_TemplateNameHelper {

	private Batch_Template__c[] templates;
	private static Integer lastAutogeneratedNumber;

    public BGE_TemplateNameHelper(Batch_Template__c[] templates) {

        this.templates = templates;
		loadLastAutogeneratedName();
    }

	public void updateName () {

		Batch_Template__c[] templatesData = new Batch_Template__c[] {};
		Batch_Template__c templateUpdated;
		String lastAutogeneratedName;

        for (Batch_Template__c template : templates) {

            if (Trigger.isInsert) {

				if (template.Name == null) {

					template.Name = 'BT - ' + lastAutogeneratedNumber;
					lastAutogeneratedNumber++;
				}
            }
        }
	}

	private void loadLastAutogeneratedName () {

		Batch_Template__c[] templates = [SELECT Id, Name, CreatedDate FROM Batch_Template__c WHERE Name Like 'BT - %' ORDER BY CreatedDate desc LIMIT 1];
		Batch_Template__c template;
		String[] templateNameSplited;
		String templateName;

		if (!templates.isEmpty()) {

			template = templates[0];
			templateName = template.Name;
			templateNameSplited = templateName.split('- ', 2);
			lastAutogeneratedNumber = Integer.valueOf(templateNameSplited[1]);
			lastAutogeneratedNumber++;
		}
        else {
            
            lastAutogeneratedNumber = 1;
        }
	}
}